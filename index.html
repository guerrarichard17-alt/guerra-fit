<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Guerra Fit Coach ‚Äì Protocolo Hipertrofia</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0" />

  <style>
    /* --- DESIGN SYSTEM (Cyberpunk Clean) --- */
    :root {
      --bg-app: #09090b;       /* Fundo Principal */
      --bg-card: #18181b;      /* Fundo Cards */
      --bg-input: #27272a;     /* Fundo Inputs */
      --border: #3f3f46;       /* Bordas */
      
      --text-main: #f4f4f5;
      --text-muted: #a1a1aa;
      
      --primary: #22c55e;      /* Verde (Conclus√£o/Cardio) */
      --primary-glow: rgba(34, 197, 94, 0.25);
      
      --accent-strength: #ef4444; /* Vermelho (For√ßa) */
      --accent-warmup: #3b82f6;   /* Azul (Aquecimento) */
      
      --radius: 12px;
      --font-stack: 'Inter', system-ui, -apple-system, sans-serif;
    }

    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    
    body {
      margin: 0;
      background: var(--bg-app);
      color: var(--text-main);
      font-family: var(--font-stack);
      font-size: 14px;
      padding-bottom: 80px; /* Espa√ßo para n√£o cobrir conte√∫do no final */
    }

    /* --- HEADER & PROGRESSO --- */
    header {
      background: rgba(9, 9, 11, 0.95);
      border-bottom: 1px solid var(--border);
      padding: 16px;
      position: sticky;
      top: 0;
      z-index: 100;
      backdrop-filter: blur(8px);
    }
    header h1 {
      margin: 0;
      font-size: 18px;
      font-weight: 800;
      letter-spacing: -0.5px;
      text-transform: uppercase;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    header small {
      color: var(--text-muted);
      font-size: 11px;
      display: block;
      margin-top: 4px;
    }

    /* Barra de Progresso */
    .progress-container {
      margin-top: 12px;
      background: var(--bg-input);
      height: 6px;
      border-radius: 99px;
      overflow: hidden;
    }
    .progress-fill {
      height: 100%;
      background: var(--primary);
      width: 0%;
      transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 0 8px var(--primary-glow);
    }
    .progress-label {
      font-size: 10px;
      color: var(--text-muted);
      text-align: right;
      margin-top: 4px;
    }

    main {
      padding: 16px;
      max-width: 800px;
      margin: 0 auto;
    }

    /* --- TABS --- */
    .main-tabs {
      display: flex;
      background: var(--bg-input);
      padding: 4px;
      border-radius: 10px;
      margin-bottom: 20px;
      position: sticky;
      top: 85px; /* Ajuste conforme altura do header */
      z-index: 90;
    }
    .main-tabs button {
      flex: 1;
      background: transparent;
      border: none;
      padding: 10px;
      font-size: 13px;
      font-weight: 600;
      border-radius: 8px;
      color: var(--text-muted);
      cursor: pointer;
      transition: all 0.2s;
    }
    .main-tabs button.active {
      background: var(--bg-card);
      color: var(--text-main);
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      border: 1px solid var(--border);
    }

    .sub-tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 15px;
      overflow-x: auto;
      padding-bottom: 4px;
    }
    .sub-tabs button {
      background: var(--bg-card);
      border: 1px solid var(--border);
      color: var(--text-muted);
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 12px;
      white-space: nowrap;
      cursor: pointer;
    }
    .sub-tabs button.active {
      background: var(--primary);
      color: #000;
      border-color: var(--primary);
      font-weight: bold;
    }

    /* --- CARDS --- */
    .card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 16px;
      margin-bottom: 16px;
    }

    /* --- EXERCISE ITEM --- */
    .exercise-card {
      background: var(--bg-card);
      border-left: 4px solid var(--border);
      padding: 14px;
      margin-bottom: 12px;
      border-radius: 8px;
      position: relative;
      transition: transform 0.1s;
    }
    .exercise-card:active { transform: scale(0.99); }

    /* Cores de Borda por Tipo */
    .type-strength { border-left-color: var(--accent-strength); } /* Vermelho */
    .type-warmup { 
      border-left-color: var(--accent-warmup); 
      background: linear-gradient(90deg, rgba(59, 130, 246, 0.05) 0%, var(--bg-card) 100%);
    }
    .type-cardio { border-left-color: var(--primary); }

    .ex-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 10px;
    }
    .ex-title {
      font-size: 15px;
      font-weight: 700;
      color: var(--text-main);
      line-height: 1.3;
    }
    .ex-subtitle {
      font-size: 11px;
      color: var(--text-muted);
      margin-top: 2px;
    }
    .badge {
      background: var(--bg-input);
      border: 1px solid var(--border);
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 10px;
      font-weight: bold;
      white-space: nowrap;
      margin-left: 8px;
    }
    .badge-warmup { color: var(--accent-warmup); border-color: var(--accent-warmup); }

    /* Inputs Area */
    .ex-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
      margin-bottom: 10px;
    }
    .input-wrapper label {
      display: block;
      font-size: 10px;
      text-transform: uppercase;
      color: var(--text-muted);
      margin-bottom: 3px;
    }
    input, textarea, select {
      width: 100%;
      background: var(--bg-input);
      border: 1px solid var(--border);
      color: var(--text-main);
      border-radius: 6px;
      padding: 10px;
      font-size: 14px;
      font-family: inherit;
    }
    input:focus { outline: 1px solid var(--primary); border-color: var(--primary); }

    .series-row {
      display: flex;
      gap: 4px;
      margin-top: 4px;
    }
    .series-row input { text-align: center; padding: 8px 2px; }

    /* Checkbox & Footer */
    .ex-footer {
      border-top: 1px solid var(--border);
      padding-top: 10px;
      margin-top: 8px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .check-label {
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      width: 100%;
    }
    .check-box {
      width: 24px;
      height: 24px;
      border: 2px solid var(--border);
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }
    input[type="checkbox"]:checked + .check-box {
      background: var(--primary);
      border-color: var(--primary);
    }
    input[type="checkbox"]:checked + .check-box::after {
      content: '‚úî';
      color: #000;
      font-size: 14px;
      font-weight: 800;
    }
    .check-text {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-muted);
    }
    input[type="checkbox"]:checked ~ .check-text {
      color: var(--primary);
    }

    /* --- SHOPPING LIST SPECIFIC --- */
    .shop-item {
      display: flex;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid var(--bg-input);
    }
    .shop-item.done .shop-name {
      text-decoration: line-through;
      color: var(--text-muted);
      opacity: 0.5;
    }

    /* UTILS */
    .hidden { display: none !important; }
    .text-center { text-align: center; }
    
    footer {
      margin-top: 40px;
      padding: 20px;
      text-align: center;
      color: #3f3f46;
      font-size: 10px;
      border-top: 1px solid var(--bg-input);
    }
  </style>
</head>

<body>

  <header>
    <h1>
      <span style="font-size:24px;">üê∫</span> 
      GUERRA FIT <span style="color:var(--primary); font-size:12px; margin-left:4px;">PRO APP</span>
    </h1>
    <small>93kg | 1,87m | Hipertrofia & Praticidade</small>

    <div id="progressArea" class="hidden">
      <div class="progress-container">
        <div id="progressBar" class="progress-fill"></div>
      </div>
      <div id="progressLabel" class="progress-label">0% Conclu√≠do</div>
    </div>
  </header>

  <main>
    <nav class="main-tabs">
      <button class="active" onclick="setTab('treino')" id="btn-treino">üèãÔ∏è TREINO</button>
      <button onclick="setTab('dieta')" id="btn-dieta">ü•ó DIETA</button>
    </nav>

    <section id="view-treino">
      
      <div class="card">
        <div class="ex-grid">
          <div class="input-wrapper">
            <label>Dia do Treino</label>
            <select id="diaSelect" onchange="renderTreino()"></select>
          </div>
          <div class="input-wrapper">
            <label>Data</label>
            <input type="date" id="dataInput" onchange="renderTreino()">
          </div>
        </div>
        <div style="font-size:11px; color:var(--text-muted); text-align:center;">
          Os dados s√£o salvos automaticamente.
        </div>
      </div>

      <div class="sub-tabs">
        <button class="active" onclick="filterTreino('todo')" id="sub-treino-todo">Todo</button>
        <button onclick="filterTreino('warmup')" id="sub-treino-warmup">Aquecimento</button>
      </div>

      <div id="treinoContainer"></div>

    </section>

    <section id="view-dieta" class="hidden">
      
      <div class="card" style="padding:10px;">
         <h4 style="margin:0 0 5px 0; color:var(--primary)">Estrat√©gia Meal Prep</h4>
         <p style="margin:0; font-size:11px; color:var(--text-muted)">
           Cozinhar Domingo para a semana. Alimentos f√°ceis de congelar.
         </p>
      </div>

      <div class="sub-tabs">
        <button class="active" onclick="renderDieta('hoje')" id="sub-dieta-hoje">Hoje</button>
        <button onclick="renderDieta('semana')" id="sub-dieta-semana">Semana</button>
        <button onclick="renderDieta('compras')" id="sub-dieta-compras">Lista de Compras</button>
      </div>

      <div id="dietaContainer"></div>

    </section>

  </main>

  <footer>
    <strong>DEV FIT COACH</strong><br>
    Lembre-se: Treino √†s 07:00 exige alimenta√ß√£o √†s 04:30.
  </footer>

  <script>
    // =================================================================
    // 1. BANCO DE DADOS: TREINOS (Hipertrofia Pr√°tica - 50min)
    // =================================================================
    const DEFAULT_TREINOS = [
      // --- SEGUNDA: PUSH (Peito, Ombro, Tr√≠ceps) ---
      { 
        dia: "Segunda", grupo: "Aquecimento", exercicio: "Manguito + Rota√ß√£o de Ombros", 
        series: "2", reps: "15-20", tipo: "Aquecimento", obs: "Leve. Aque√ßa a articula√ß√£o antes de pegar peso." 
      },
      { 
        dia: "Segunda", grupo: "Peito", exercicio: "Supino Inclinado (Halter ou M√°quina)", 
        series: "4", reps: "8-10", tipo: "For√ßa", obs: "Foco no peitoral superior. Descanso 2 min." 
      },
      { 
        dia: "Segunda", grupo: "Peito", exercicio: "Supino Reto / Peck Deck", 
        series: "3", reps: "10-12", tipo: "Hipertrofia", obs: "Cad√™ncia controlada na descida." 
      },
      { 
        dia: "Segunda", grupo: "Ombro", exercicio: "Eleva√ß√£o Lateral", 
        series: "4", reps: "15", tipo: "Metab√≥lico", obs: "Cotovelos levemente flexionados. N√£o roube." 
      },
      { 
        dia: "Segunda", grupo: "Tr√≠ceps", exercicio: "Tr√≠ceps Polia (Corda ou Barra)", 
        series: "4", reps: "10-12", tipo: "Hipertrofia", obs: "Estenda todo o bra√ßo." 
      },

      // --- TER√áA: PULL (Costas, Trap√©zio, B√≠ceps) ---
      { 
        dia: "Ter√ßa", grupo: "Aquecimento", exercicio: "Retra√ß√£o Escapular no Pulley", 
        series: "2", reps: "15", tipo: "Aquecimento", obs: "Ative as costas antes de puxar carga." 
      },
      { 
        dia: "Ter√ßa", grupo: "Costas", exercicio: "Levantamento Terra (Rack ou Completo)", 
        series: "3", reps: "5-6", tipo: "For√ßa", obs: "Carga alta. Base de for√ßa. Cuidado com a lombar." 
      },
      { 
        dia: "Ter√ßa", grupo: "Costas", exercicio: "Puxada Alta (Aberta)", 
        series: "4", reps: "8-10", tipo: "Hipertrofia", obs: "Puxe at√© o peito." 
      },
      { 
        dia: "Ter√ßa", grupo: "Costas", exercicio: "Remada Curvada (M√°quina ou Barra)", 
        series: "3", reps: "12", tipo: "Hipertrofia", obs: "Esmague as costas no final." 
      },
      { 
        dia: "Ter√ßa", grupo: "B√≠ceps", exercicio: "Rosca Direta (Barra ou Halter)", 
        series: "4", reps: "8-12", tipo: "Hipertrofia", obs: "Sem balan√ßar o tronco." 
      },

      // --- QUARTA: LEGS 1 (Foco Quadr√≠ceps) ---
      { 
        dia: "Quarta", grupo: "Aquecimento", exercicio: "Agachamento Peso do Corpo + Mobilidade Quadril", 
        series: "2", reps: "15", tipo: "Aquecimento", obs: "Solte o quadril." 
      },
      { 
        dia: "Quarta", grupo: "Quadr√≠ceps", exercicio: "Agachamento Livre", 
        series: "4", reps: "6-8", tipo: "For√ßa", obs: "Rei dos exerc√≠cios. Amplitude m√°xima." 
      },
      { 
        dia: "Quarta", grupo: "Quadr√≠ceps", exercicio: "Leg Press 45", 
        series: "4", reps: "10-12", tipo: "Hipertrofia", obs: "N√£o tranque o joelho na subida." 
      },
      { 
        dia: "Quarta", grupo: "Quadr√≠ceps", exercicio: "Cadeira Extensora", 
        series: "3", reps: "15", tipo: "Metab√≥lico", obs: "Segure 1s em cima (pico de contra√ß√£o)." 
      },
      { 
        dia: "Quarta", grupo: "Panturrilha", exercicio: "G√™meos Sentado ou em P√©", 
        series: "4", reps: "15-20", tipo: "Resist√™ncia", obs: "Amplitude total." 
      },

      // --- QUINTA: DESCANSO ATIVO ---
      { 
        dia: "Quinta", grupo: "Recupera√ß√£o", exercicio: "Mobilidade Geral / Alongamento", 
        series: "1", reps: "20 min", tipo: "Aquecimento", obs: "Foque em alongar peitoral e flexores de quadril." 
      },
      { 
        dia: "Quinta", grupo: "Cardio", exercicio: "Caminhada Leve (Zona 1)", 
        series: "1", reps: "30-40 min", tipo: "Cardio", obs: "Apenas para circula√ß√£o sangu√≠nea. Sem impacto." 
      },

      // --- SEXTA: UPPER BODY (Peito + Costas) ---
      { 
        dia: "Sexta", grupo: "Aquecimento", exercicio: "Giro de Bra√ßos + Flex√£o de Bra√ßo (Ch√£o)", 
        series: "2", reps: "15", tipo: "Aquecimento", obs: "Prepare o corpo todo." 
      },
      { 
        dia: "Sexta", grupo: "Peito/Costas", exercicio: "Supino Inclinado M√°quina", 
        series: "3", reps: "10-12", tipo: "Hipertrofia", obs: "Super-s√©rie se poss√≠vel." 
      },
      { 
        dia: "Sexta", grupo: "Peito/Costas", exercicio: "Puxada Tri√¢ngulo (Fechada)", 
        series: "3", reps: "10-12", tipo: "Hipertrofia", obs: "Foco no miolo das costas." 
      },
      { 
        dia: "Sexta", grupo: "Ombros", exercicio: "Desenvolvimento M√°quina", 
        series: "3", reps: "10-12", tipo: "Hipertrofia", obs: "Carga moderada." 
      },
      { 
        dia: "Sexta", grupo: "Bra√ßos", exercicio: "Rosca Martelo + Tr√≠ceps Corda", 
        series: "3", reps: "12+12", tipo: "Metab√≥lico", obs: "Bi-set para economizar tempo." 
      },

      // --- S√ÅBADO: LEGS 2 (Posterior e Gl√∫teo) ---
      { 
        dia: "S√°bado", grupo: "Aquecimento", exercicio: "Eleva√ß√£o P√©lvica (Solo) sem peso", 
        series: "2", reps: "20", tipo: "Aquecimento", obs: "Acorde o gl√∫teo." 
      },
      { 
        dia: "S√°bado", grupo: "Posterior", exercicio: "Stiff (Barra ou Halter)", 
        series: "4", reps: "8-10", tipo: "For√ßa", obs: "Coluna reta. Sinta alongar o posterior." 
      },
      { 
        dia: "S√°bado", grupo: "Posterior", exercicio: "Mesa Flexora", 
        series: "4", reps: "12-15", tipo: "Hipertrofia", obs: "At√© a falha." 
      },
      { 
        dia: "S√°bado", grupo: "Pernas Geral", exercicio: "Afundo / Passada", 
        series: "3", reps: "12 passadas", tipo: "Metab√≥lico", obs: "Finalizador." 
      },

      // --- DOMINGO: OFF ---
      { 
        dia: "Domingo", grupo: "Descanso", exercicio: "Descanso Total", 
        series: "-", reps: "-", tipo: "Recupera√ß√£o", obs: "Prepare as marmitas da semana!" 
      }
    ];

    // =================================================================
    // 2. BANCO DE DADOS: DIETA (Meal Prep + 04:30h Start)
    // =================================================================
    const DEFAULT_DIETA = [
      // PADR√ÉO DI√ÅRIO (Seg-Sex)
      { dia: "Segunda", refeicao: "1. Desjejum (04:30)", item: "Overnight Oats (Aveia+Whey+Leite)", qtd: 1, un: "pote", grupo: "Pr√°tico" },
      { dia: "Segunda", refeicao: "1. Desjejum (04:30)", item: "Banana", qtd: 1, un: "un", grupo: "Carbo" },
      { dia: "Ter√ßa",   refeicao: "1. Desjejum (04:30)", item: "Ovos Mexidos", qtd: 4, un: "un", grupo: "Prote√≠na" },
      { dia: "Ter√ßa",   refeicao: "1. Desjejum (04:30)", item: "P√£o Integral", qtd: 2, un: "fatias", grupo: "Carbo" },
      { dia: "Quarta",  refeicao: "1. Desjejum (04:30)", item: "Overnight Oats (Aveia+Whey+Leite)", qtd: 1, un: "pote", grupo: "Pr√°tico" },
      { dia: "Quinta",  refeicao: "1. Desjejum (04:30)", item: "Ovos Mexidos", qtd: 4, un: "un", grupo: "Prote√≠na" },
      { dia: "Quinta",  refeicao: "1. Desjejum (04:30)", item: "P√£o Integral", qtd: 2, un: "fatias", grupo: "Carbo" },
      { dia: "Sexta",   refeicao: "1. Desjejum (04:30)", item: "Vitamina (Whey+Banana+Aveia)", qtd: 1, un: "copo", grupo: "L√≠quido" },

      // P√ìS TREINO (Trabalho)
      { dia: "Segunda", refeicao: "2. P√≥s-Treino (08:30)", item: "Iogurte Natural + Whey", qtd: 1, un: "dose", grupo: "Prote√≠na" },
      { dia: "Ter√ßa",   refeicao: "2. P√≥s-Treino (08:30)", item: "Iogurte Natural + Whey", qtd: 1, un: "dose", grupo: "Prote√≠na" },
      { dia: "Quarta",  refeicao: "2. P√≥s-Treino (08:30)", item: "Iogurte Natural + Whey", qtd: 1, un: "dose", grupo: "Prote√≠na" },
      { dia: "Quinta",  refeicao: "2. P√≥s-Treino (08:30)", item: "Barra Prote√≠na", qtd: 1, un: "un", grupo: "Pr√°tico" },
      { dia: "Sexta",   refeicao: "2. P√≥s-Treino (08:30)", item: "Iogurte Natural + Whey", qtd: 1, un: "dose", grupo: "Prote√≠na" },

      // ALMO√áO (Marmitas Congeladas)
      { dia: "Segunda", refeicao: "3. Almo√ßo", item: "Patinho Mo√≠do refogado", qtd: 200, un: "g", grupo: "Prote√≠na" },
      { dia: "Segunda", refeicao: "3. Almo√ßo", item: "Arroz Branco", qtd: 250, un: "g", grupo: "Carbo" },
      { dia: "Ter√ßa",   refeicao: "3. Almo√ßo", item: "Frango em Cubos (Molho)", qtd: 200, un: "g", grupo: "Prote√≠na" },
      { dia: "Ter√ßa",   refeicao: "3. Almo√ßo", item: "Pur√™ Batata/Mandioca", qtd: 250, un: "g", grupo: "Carbo" },
      { dia: "Quarta",  refeicao: "3. Almo√ßo", item: "Patinho Mo√≠do", qtd: 200, un: "g", grupo: "Prote√≠na" },
      { dia: "Quarta",  refeicao: "3. Almo√ßo", item: "Macarr√£o Integral", qtd: 200, un: "g", grupo: "Carbo" },
      { dia: "Quinta",  refeicao: "3. Almo√ßo", item: "Frango Desfiado", qtd: 200, un: "g", grupo: "Prote√≠na" },
      { dia: "Quinta",  refeicao: "3. Almo√ßo", item: "Arroz com Legumes", qtd: 250, un: "g", grupo: "Carbo" },
      { dia: "Sexta",   refeicao: "3. Almo√ßo", item: "Peixe (Til√°pia) ou Carne", qtd: 200, un: "g", grupo: "Prote√≠na" },
      { dia: "Sexta",   refeicao: "3. Almo√ßo", item: "Batata Assada", qtd: 250, un: "g", grupo: "Carbo" },

      // JANTAR
      { dia: "Segunda", refeicao: "4. Jantar", item: "Omelete (3 ovos)", qtd: 1, un: "un", grupo: "Jantar Leve" },
      { dia: "Ter√ßa",   refeicao: "4. Jantar", item: "Carne Mo√≠da (Marmita)", qtd: 150, un: "g", grupo: "Prote√≠na" },
      { dia: "Quarta",  refeicao: "4. Jantar", item: "Frango Cubos", qtd: 150, un: "g", grupo: "Prote√≠na" },
      { dia: "Quinta",  refeicao: "4. Jantar", item: "Ovos Cozidos", qtd: 4, un: "un", grupo: "Jantar Leve" },
      { dia: "Sexta",   refeicao: "4. Jantar", item: "Livre (Controlado)", qtd: 1, un: "ref", grupo: "Social" },
      
      // FDS
      { dia: "S√°bado", refeicao: "Almo√ßo", item: "Churrasco / Carne", qtd: 300, un: "g", grupo: "Prote√≠na" },
      { dia: "Domingo", refeicao: "Geral", item: "Refei√ß√£o Livre", qtd: 1, un: "un", grupo: "Social" }
    ];

    // =================================================================
    // 3. APP LOGIC
    // =================================================================
    const STORAGE_KEY = "guerra_fit_logs_final";
    let dailyLog = {};

    function init() {
      // 1. Carrega Logs
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        dailyLog = raw ? JSON.parse(raw) : {};
      } catch { dailyLog = {}; }

      // 2. Data de Hoje
      const hoje = new Date();
      const offset = hoje.getTimezoneOffset() * 60000;
      const localISO = new Date(hoje.getTime() - offset).toISOString().slice(0, 10);
      document.getElementById("dataInput").value = localISO;

      // 3. Preenche Select de Dias
      const diasUnicos = ["Segunda", "Ter√ßa", "Quarta", "Quinta", "Sexta", "S√°bado", "Domingo"];
      const sel = document.getElementById("diaSelect");
      diasUnicos.forEach(d => {
        const opt = document.createElement("option");
        opt.value = d;
        opt.textContent = d;
        sel.appendChild(opt);
      });

      // 4. Seleciona dia da semana atual
      const diaSemanaMap = ["Domingo","Segunda","Ter√ßa","Quarta","Quinta","Sexta","S√°bado"];
      const hojeNome = diaSemanaMap[hoje.getDay()];
      sel.value = hojeNome;

      renderTreino();
    }

    // --- RENDER TREINO ---
    function renderTreino() {
      const container = document.getElementById("treinoContainer");
      container.innerHTML = "";
      
      const diaSel = document.getElementById("diaSelect").value;
      const dataSel = document.getElementById("dataInput").value;
      const filtro = document.querySelector(".sub-tabs button.active").id; // sub-treino-todo ou warmup

      // Filtra Exercicios do Dia
      let exercicios = DEFAULT_TREINOS.filter(e => e.dia === diaSel);

      if(exercicios.length === 0) {
        container.innerHTML = `<div class="card text-center" style="color:var(--text-muted)">Sem treinos configurados para ${diaSel}.</div>`;
        document.getElementById("progressArea").classList.add("hidden");
        return;
      }

      document.getElementById("progressArea").classList.remove("hidden");

      exercicios.forEach((ex, idx) => {
        // Filtro visual (Aquecimento vs Todo)
        const isWarmup = ex.tipo === "Aquecimento";
        if(filtro === "sub-treino-warmup" && !isWarmup) return;

        const key = `ex_${diaSel}_${idx}::${dataSel}`;
        const log = dailyLog[key] || {};

        // Define Classe CSS do Card
        let typeClass = "type-strength"; // Padr√£o
        if(isWarmup) typeClass = "type-warmup";
        if(ex.tipo === "Cardio" || ex.tipo === "Metab√≥lico") typeClass = "type-cardio";

        // HTML Card
        const div = document.createElement("div");
        div.className = `exercise-card ${typeClass}`;
        div.innerHTML = `
          <div class="ex-header">
            <div>
              <div class="ex-title">${ex.exercicio}</div>
              <div class="ex-subtitle">${ex.grupo} ‚Ä¢ ${ex.tipo}</div>
            </div>
            ${isWarmup ? '<span class="badge badge-warmup">AQUECER</span>' : ''}
          </div>

          <div style="font-size:12px; color:var(--text-main); margin-bottom:8px;">
             <strong>Meta:</strong> ${ex.series} S√©ries x ${ex.reps} | <em>"${ex.obs}"</em>
          </div>

          <div class="ex-grid">
            <div class="input-wrapper">
              <label>Carga (kg)</label>
              <input type="number" placeholder="Kg" value="${log.carga || ''}" onchange="saveEx('${key}', 'carga', this.value)">
            </div>
            <div class="input-wrapper">
              <label>RPE (1-10)</label>
              <input type="number" placeholder="Intensidade" value="${log.rpe || ''}" onchange="saveEx('${key}', 'rpe', this.value)">
            </div>
          </div>
          
          <div class="ex-footer">
             <label class="check-label">
                <input type="checkbox" class="hidden" ${log.done ? 'checked' : ''} onchange="saveEx('${key}', 'done', this.checked)">
                <div class="check-box"></div>
                <div class="check-text">${log.done ? 'CONCLU√çDO' : 'FINALIZAR EXERC√çCIO'}</div>
             </label>
          </div>
        `;
        container.appendChild(div);
      });

      updateProgress();
    }

    function saveEx(key, field, val) {
      if(!dailyLog[key]) dailyLog[key] = {};
      dailyLog[key][field] = val;
      localStorage.setItem(STORAGE_KEY, JSON.stringify(dailyLog));
      
      if(field === 'done') {
        renderTreino(); // Re-render para atualizar texto/cor
      }
    }

    function updateProgress() {
      const diaSel = document.getElementById("diaSelect").value;
      const dataSel = document.getElementById("dataInput").value;
      const total = DEFAULT_TREINOS.filter(e => e.dia === diaSel).length;
      
      let doneCount = 0;
      DEFAULT_TREINOS.forEach((ex, idx) => {
        if(ex.dia !== diaSel) return;
        const key = `ex_${diaSel}_${idx}::${dataSel}`;
        if(dailyLog[key] && dailyLog[key].done) doneCount++;
      });

      const pct = total === 0 ? 0 : Math.round((doneCount / total) * 100);
      document.getElementById("progressBar").style.width = pct + "%";
      document.getElementById("progressLabel").textContent = `${pct}% Conclu√≠do`;
    }

    // --- RENDER DIETA ---
    function renderDieta(modo) {
      // Atualiza bot√µes
      document.querySelectorAll(".sub-tabs button").forEach(b => b.classList.remove("active"));
      if(modo === 'hoje') document.getElementById("sub-dieta-hoje").classList.add("active");
      if(modo === 'semana') document.getElementById("sub-dieta-semana").classList.add("active");
      if(modo === 'compras') document.getElementById("sub-dieta-compras").classList.add("active");

      const container = document.getElementById("dietaContainer");
      container.innerHTML = "";

      // 1. MODO HOJE
      if(modo === 'hoje') {
         const dataInput = document.getElementById("dataInput").value;
         // Descobre dia da semana da data inputada
         const d = new Date(dataInput);
         const diaSemanaMap = ["Domingo","Segunda","Ter√ßa","Quarta","Quinta","Sexta","S√°bado"];
         // Ajuste timezone simples
         const userDia = diaSemanaMap[new Date(d.getTime() + d.getTimezoneOffset()*60000).getDay()];

         const itens = DEFAULT_DIETA.filter(i => i.dia === userDia);
         
         if(itens.length === 0) {
            container.innerHTML = `<div class="card text-center">Sem card√°pio espec√≠fico para ${userDia}.</div>`;
            return;
         }
         
         // Agrupa por refei√ß√£o
         const refs = [...new Set(itens.map(i => i.refeicao))];
         refs.forEach(refNome => {
            const div = document.createElement("div");
            div.className = "card";
            let html = `<h4 style="margin:0 0 10px 0; color:var(--primary); font-size:14px;">${refNome}</h4>`;
            
            itens.filter(i => i.refeicao === refNome).forEach(alimento => {
               html += `
                 <div style="display:flex; justify-content:space-between; border-bottom:1px solid var(--bg-input); padding:6px 0;">
                    <span>${alimento.item}</span>
                    <strong style="color:var(--text-main)">${alimento.qtd} ${alimento.un}</strong>
                 </div>
               `;
            });
            div.innerHTML = html;
            container.appendChild(div);
         });
      }

      // 2. MODO SEMANA (Resumo Almo√ßo/Jantar)
      if(modo === 'semana') {
         const dias = ["Segunda","Ter√ßa","Quarta","Quinta","Sexta"];
         dias.forEach(dia => {
            const itensDia = DEFAULT_DIETA.filter(i => i.dia === dia);
            const almoco = itensDia.find(i => i.refeicao.includes("Almo√ßo"))?.item || "-";
            const jantar = itensDia.find(i => i.refeicao.includes("Jantar"))?.item || "-";

            const div = document.createElement("div");
            div.className = "card";
            div.innerHTML = `
              <div style="font-weight:bold; color:var(--text-muted); margin-bottom:5px;">${dia}</div>
              <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
                 <div><span style="font-size:10px;">‚òÄÔ∏è ALMO√áO</span><br>${almoco}</div>
                 <div><span style="font-size:10px;">üåô JANTAR</span><br>${jantar}</div>
              </div>
            `;
            container.appendChild(div);
         });
      }

      // 3. MODO COMPRAS (Checklist)
      if(modo === 'compras') {
         // Agrega itens
         let lista = {};
         DEFAULT_DIETA.forEach(d => {
            const nome = d.item;
            if(!lista[nome]) lista[nome] = { qtd: 0, un: d.un, grupo: d.grupo };
            lista[nome].qtd += (typeof d.qtd === 'number' ? d.qtd : 0);
         });

         const div = document.createElement("div");
         div.className = "card";
         div.innerHTML = `<h4 style="margin-top:0;">Lista de Supermercado</h4>`;
         
         // Ordena alfab√©tico
         Object.keys(lista).sort().forEach((nome, idx) => {
             const it = lista[nome];
             const idCheck = `shop_${idx}`;
             div.innerHTML += `
               <label class="shop-item" onclick="this.classList.toggle('done')">
                  <div style="flex:1">
                     <div class="shop-name" style="font-weight:600">${nome}</div>
                     <div style="font-size:11px; color:var(--text-muted)">${it.grupo}</div>
                  </div>
                  <div style="font-weight:bold; color:var(--primary)">${it.qtd > 0 ? it.qtd : ''} ${it.un}</div>
               </label>
             `;
         });
         container.appendChild(div);
      }
    }

    // --- NAVEGA√á√ÉO GERAL ---
    function setTab(tab) {
      document.getElementById("btn-treino").classList.remove("active");
      document.getElementById("btn-dieta").classList.remove("active");
      document.getElementById(`btn-${tab}`).classList.add("active");

      document.getElementById("view-treino").classList.add("hidden");
      document.getElementById("view-dieta").classList.add("hidden");
      document.getElementById(`view-${tab}`).classList.remove("hidden");
    }

    function filterTreino(tipo) {
       document.getElementById("sub-treino-todo").classList.remove("active");
       document.getElementById("sub-treino-warmup").classList.remove("active");
       document.getElementById(`sub-treino-${tipo}`).classList.add("active");
       renderTreino();
    }

    // INIT
    document.addEventListener("DOMContentLoaded", init);

  </script>
</body>
</html>
